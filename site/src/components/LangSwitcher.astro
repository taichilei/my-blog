---
import type { Lang } from '../i18n';

interface Props {
	currentLang: Lang;
}

const { currentLang } = Astro.props;

const switchLang = currentLang === 'zh' ? 'en' : 'zh';
const switchLangLabel = currentLang === 'zh' ? 'EN' : '中文';

const base = import.meta.env.BASE_URL;
const path = Astro.url.pathname;
const pathWithoutBase = path.startsWith(base) ? path.slice(base.length - 1) : path;
const newPath = pathWithoutBase.startsWith(`/${currentLang}/`)
	? `${base}${switchLang}${pathWithoutBase.slice(currentLang.length + 1)}`
	: `${base}${switchLang}${pathWithoutBase}`;
---

<a
	class="lang-switcher"
	href={newPath}
	title={`切换到 ${switchLangLabel}`}
>
	{switchLangLabel}
</a>

<style>
	.lang-switcher {
		padding: 0.5em;
		margin-left: 0.5em;
		text-decoration: none;
		color: rgb(var(--black));
		font-weight: 700;
		border-radius: 6px;
		transition: 0.2s ease;
	}
	.lang-switcher:hover {
		background: rgba(var(--gray-light), 50%);
	}
</style>
